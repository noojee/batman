logPath: /var/log/si.log
sendEmailOnFail: false
sendEmailOnSuccess: false

# emailServerFQDN: localhost
emailServerPort: 25
# emailFromAddress: scanner@mydomain.com
# emailFailToAddress: failed.scan@mydomain.com
# emailSuccessToAddress: successful.scan@mydomain.com


# List of file system entities (directories and/or files) that are to be included in the baseline
entities:
  - /home/bsutton/home 
  # - /sbin
  # - /usr/bin
  # - /usr/sbin
  # - /etc
  # - /opt

# List of file system entities (files or directories) that are to be excluded from the baseline.
# These entities must be children of one of the directories
# listed in the entities section.
exclusions:
  - /dev
  - /sys
  - /proc
  - /tmp
  - /run
  - /home
  - /mnt/stateful_partition/home
  - /mnt/stateful_partition/var/lib/cni
  - /mnt/stateful_partition/var/lib/docker/containers
  - /mnt/stateful_partition/var/lib/docker/image
  - /mnt/stateful_partition/var/lib/docker/overlay2
  - /mnt/stateful_partition/var/lib/docker/network
  - /mnt/stateful_partition/var/lib/docker/volumes
  - /mnt/stateful_partition/var/lib/dockershim
  - /mnt/stateful_partition/var/lib/kubelet/pods
  - /mnt/stateful_partition/var/lib/metrics
  - /mnt/stateful_partition/var/lib/update_engine/prefs
  - /mnt/stateful_partition/var/log
  - /mnt/stateful_partition/var_overlay
  - /var/lib/cni
  - /var/lib/docker/containers
  - /var/lib/docker/image
  - /var/lib/docker/network
  - /var/lib/docker/overlay2
  - /var/lib/docker/volumes
  - /var/lib/dockershim
  - /var/lib/kubelet/plugins
  - /var/lib/kubelet/pods
  - /var/lib/metrics
  - /var/lib/update_engine/prefs
  - /var/log
  - /log/journal



log_audits:
  # global selectors apply to every log_source
  global_selectors:
    - selector:
      type: creditcard
      description: A credit card was detected in a log file
      risk: critical

  log_sources:
    - log_source:
      type: njcontact
      description: Noojee Contact logs - unknown
      top: 10
      reset: Starting Servlet engine
      selectors:
        - selector:
          description: I have no idea
          type: contains
          match: [" "]
          risk: low
    - log_source:
      description: File Integrity logs
      type: file
      top: 1000
      path: /var/log/batman.log
      selectors:
        - selector:
          type: contains
          description: The contents of a file has changed which may indicate an intruder.
          match: ['Integrity:']
          risk: critical
          continue: false
        - selector:
          description: A baseline of scan failed to process a file due to permission denied.
          type: contains
          match: ['permission denied']
          risk: medium
          continue: false
        - selector:
          type: contains
          description: An error was detected
          match: ['Error']
          risk: critical
          continue: false
        - selector:
          type: contains
          description: a warning was detected
          match: ['Warning']
          risk: high
          continue: false
        
    - log_source:
      type: njcontact
      top: 1000
      description: Noojee Contact logs
      trim_prefix: ':::'
      selectors:
        - selector:
          description: ignore deleterious lines
          type: contains
          continue: false
          match: 
            - 'AgiHangupException'
            - 'Setting logging level to'
            - 'com.mysql.cj.'
            - 'RejectedExecutionHandlerImpl'
            - 'Logs begin at'
            - 'LoggingOutputStream'
          risk: none
        - selector:
          description: The java VM is pausing excessively due to GC.
          type: contains
          match: ["jvm pause"]
          risk: medium
        - selector:
          description: Locker
          type: contains
          match: ["Locker"]
          risk: medium
        - selector:
          description: Slow
          type: contains
          match: ["Slow"]
          risk: low
        - selector:
          description: Java is reporting an out of memory condition
          type: contains
          match: ["Terminating due to java.lang.OutOfMemoryError"]
          risk: high
        - selector:
          description: Saving a lead failed due to a wrong or no lead.
          type: contains
          match: ["Unable to save changes (Wrong or no lead)"]
          risk: high
        - selector:
          description: An error was detected
          type: one_of
          match: ['ERROR']
          exclude: ["Erroneous"]
          risk: high
        - selector:
          description: An warning was detected
          type: one_of
          match: ['Warning']
          risk: medium
        - selector:
          description: Testing
          type: contains
          match: ["example_test"]
          risk: critical
          

      



